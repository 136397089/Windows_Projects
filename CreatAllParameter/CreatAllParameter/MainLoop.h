#pragma once
#include "stdafx.h"
#include "Number/NumberInter.h"
#include "Locker.h"
#include "Number/IndexNumber.h"

class CMainLoop
{
public:
	CMainLoop();
	~CMainLoop();

	fstream resultFileCsv;
	int FileNumber;
	float FileIndex;
	CNumberManager FileTool;

	HANDLE _StockCSVFileMutex;

	//////////////////////////////////////////////////////////////////////////
	//更新目录下所有CSV文件里的值
	//////////////////////////////////////////////////////////////////////////
	bool RunLoop(string strFolderPath);
	//////////////////////////////////////////////////////////////////////////
	//统计文件夹下文件的个数
	//////////////////////////////////////////////////////////////////////////
	bool StatisticalFileQuantity(string strPath);

	//////////////////////////////////////////////////////////////////////////
	//将计算完的数据保存到文件当中
	//////////////////////////////////////////////////////////////////////////
	bool SaveDataToFile(const string& strFilePath,const AllStockData & allData);
};

